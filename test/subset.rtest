
test_coercion <- function() {
	ff <- melt(french_fries, id=1:4)
	test <- cast(ff, rep ~ variable, mean)	
	
	assert_equal(as.matrix(test), as.matrix(as.data.frame(as.matrix(test))))
}

test_subset <- function() {
	ff <- melt(french_fries, id=1:4)
	ff$time2 <- as.character(ff$time) > 5
	test <- cast(ff, treatment + rep ~ variable + time2, mean, subset=variable %in% c("grassy", "painty"))	
	testm <- as.matrix(test)
	
	assert_equal(test, as.data.frame(testm))
	assert_equal(testm, as.matrix(testm))
	
	
	
}

test_formula_checking <- function() {
	assert.error(deshape(data.frame(a=1,b=2,c=4), id=c("e")))
	assert.error(deshape(data.frame(a=1,b=2,c=4), m=c("e","a")))
	assert.error(deshape(data.frame(a=1,b=2,c=4)))
}

test_basic_mekt <- function() {
	data(CO2)
	data(airquality)
	
	CO2.d <- melt(CO2, m="uptake")
	assert.equal(c(84,6), dim(CO2.d))

	aqm <- melt(airquality, id=c("Month", "Day"))
	assert.equal(c(568, 4), dim(aqm))
	
}

test_single_col <- function() {
	one_col <- data.frame(a=1:6)
	
	assert.equal(one_col, melt(one_col, id="a"))
	
	expected <- data.frame(variable=I("a"), value=1:6)
	expected$variable <- as.character(expected$variable)
	assert.equal(expected, melt(one_col, measure="a"))
	
}